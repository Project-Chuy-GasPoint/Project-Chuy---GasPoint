<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GasPoint - Cooking Gas Locator</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>

<div>
  <input id="locationSearch" placeholder="Enter barangay (damilag, alae, manolo)">
  <button onclick="searchLocation()">Search</button>
</div>

<div id="map"></div>

<script>
document.getElementById("map").style.height = window.innerHeight + "px";

const street = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", { attribution: "" });
const satellite = L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}", { attribution: "" });

const map = L.map("map", { center: [8.3646, 124.8651], zoom: 13, layers: [street] });
L.control.layers({ "Street": street, "Satellite": satellite }).addTo(map);

let gasStores = [];

fetch("gaspoint-data.json")
  .then(r => r.json())
  .then(data => {
    gasStores = data;
    gasStores.forEach(store => {

      let popupHtml = 
        "<b>" + store.title + "</b><br>" +
        store.description +
        (store.contact ? "<br><b>Contact:</b> " + store.contact : "");

      
      if (store.image) {
        popupHtml += `<br><img src="${store.image}" width="150">`;
      }

      L.marker([store.lat, store.lng]).addTo(map).bindPopup(popupHtml);
    });
  });


const knownLocations = {
  "damilag": [8.3503, 124.8121],
  "alae": [8.4208119, 124.8133793],
  "manolo": [8.3646, 124.8651]
};

function searchLocation() {
  const q = document.getElementById("locationSearch").value.toLowerCase();
  if (!knownLocations[q]) return;
  map.setView(knownLocations[q], 15);
}
</script>

</body>
</html>
